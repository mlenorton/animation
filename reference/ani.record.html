<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="These two functions use recordPlot and replayPlot
to record image frames and replay the animation respectively.
Replay the animation"><title>Record and replay animations — ani.record • animation</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Record and replay animations — ani.record"><meta property="og:description" content="These two functions use recordPlot and replayPlot
to record image frames and replay the animation respectively.
Replay the animation"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">animation</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.7.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/yihui/animation/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Record and replay animations</h1>
      <small class="dont-index">Source: <a href="https://github.com/yihui/animation/blob/HEAD/R/ani.record.R" class="external-link"><code>R/ani.record.R</code></a></small>
      <div class="d-none name"><code>ani.record.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>These two functions use <code><a href="https://rdrr.io/r/grDevices/recordplot.html" class="external-link">recordPlot</a></code> and <code><a href="https://rdrr.io/r/grDevices/recordplot.html" class="external-link">replayPlot</a></code>
to record image frames and replay the animation respectively.</p>
<p>Replay the animation</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">ani.record</span><span class="op">(</span>reset <span class="op">=</span> <span class="cn">FALSE</span>, replay.cur <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">ani.replay</span><span class="op">(</span><span class="va">list</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>reset</dt>
<dd><p>if <code>TRUE</code>, the recording list will be cleared, otherwise
new plots will be appended to the existing list of recorded plots</p></dd>


<dt>replay.cur</dt>
<dd><p>whether to replay the current plot (we can set both
<code>reset</code> and <code>replay.cur</code> to <code>TRUE</code> so that low-level
plotting changes can be captured by off-screen graphics devices without
storing all the plots in memory; see Note)</p></dd>


<dt>list</dt>
<dd><p>a list of recorded plots; if missing, the recorded plots by
<code>ani.record</code> will be used</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>Invisible <code>NULL</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>One difficulty in capturing images in R (base graphics) is that the
off-screen graphics devices cannot capture low-level plotting commands as
<em>new</em> image files -- only high-level plotting commands can produce new
image files; <code>ani.record</code> uses <code><a href="https://rdrr.io/r/grDevices/recordplot.html" class="external-link">recordPlot</a></code> to record
the plots when any changes are made on the current plot. For a graphical
device to be recordable, you have to call <code>dev.control('enable')</code> before
plotting.</p>
<p><code>ani.replay</code> can replay the recorded plots as an
  animation. Moreover, we can convert the recorded plots to other formats
  too, e.g. use <code><a href="saveHTML.html">saveHTML</a></code> and friends.</p>
<p>The recorded plots are stored as a list in <code>.ani.env$.images</code>, which
  is the default value to be passed to <code>ani.replay</code>;
  <code>.ani.env</code> is an invisible <code><a href="https://rdrr.io/r/base/environment.html" class="external-link">environment</a></code> created when this
  package is loaded, and it will be used to store some commonly used objects
  such as animation options (<code><a href="ani.options.html">ani.options</a></code>).</p>
    </div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p>Although we can record changes made by low-level plotting commands
  using <code>ani.record</code>, there is a price to pay -- we need memory
  to store the recorded plots, which are usually verg large when the plots
  are complicated (e.g. we draw millions of points or polygons in a single
  plot). However, we can set <code>replay.cur</code> to force R to produce a new
  copy of the current plot, which will be automatically recorded by
  off-screen grapihcs devices as <em>new</em> image files. This method has a
  limitation: we must open a screen device to assist R to record the plots.
  See the last example below. We must be very careful that no other graphics
  devices are opened before we use this function.</p>
<p>If we use base graphics, we should bear in mind that the background colors
  of the plots might be transparent, which could lead to problems in HTML
  animation pages when we use the <code><a href="https://rdrr.io/r/grDevices/png.html" class="external-link">png</a></code> device (see the examples
  below).</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Examples at <a href="https://yihui.org/animation/example/ani-record/" class="external-link">https://yihui.org/animation/example/ani-record/</a></p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="https://rdrr.io/r/grDevices/recordplot.html" class="external-link">recordPlot</a></code> and <code><a href="https://rdrr.io/r/grDevices/recordplot.html" class="external-link">replayPlot</a></code>;
  <code><a href="ani.pause.html">ani.pause</a></code></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Yihui Xie</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://yihui.org/animation/" class="external-link">animation</a></span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">n</span> <span class="op">=</span> <span class="fl">20</span></span></span>
<span class="r-in"><span><span class="va">x</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">y</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">## set up an empty frame, then add points one by one</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>bg <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span>  <span class="co"># ensure the background color is white</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, type <span class="op">=</span> <span class="st">"n"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">ani.record</span><span class="op">(</span>reset <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>  <span class="co"># clear history before recording</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">n</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, <span class="va">y</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, pch <span class="op">=</span> <span class="fl">19</span>, cex <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="fu">ani.record</span><span class="op">(</span><span class="op">)</span>  <span class="co"># record the current frame</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-plt img"><img src="ani.record-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## now we can replay it, with an appropriate pause between frames</span></span></span>
<span class="r-in"><span><span class="va">oopts</span> <span class="op">=</span> <span class="fu"><a href="ani.options.html">ani.options</a></span><span class="op">(</span>interval <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">ani.replay</span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## or export the animation to an HTML page</span></span></span>
<span class="r-in"><span><span class="fu"><a href="saveHTML.html">saveHTML</a></span><span class="op">(</span><span class="fu">ani.replay</span><span class="op">(</span><span class="op">)</span>, img.name <span class="op">=</span> <span class="st">"record_plot"</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> animation option 'nmax' changed: 50 --&gt; 20</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> animation option 'nmax' changed: 20 --&gt; 50</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> HTML file created at: index.html</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## record plots and replay immediately</span></span></span>
<span class="r-in"><span><span class="fu"><a href="saveHTML.html">saveHTML</a></span><span class="op">(</span><span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/grDevices/dev2.html" class="external-link">dev.control</a></span><span class="op">(</span><span class="st">"enable"</span><span class="op">)</span>  <span class="co"># enable recording</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>bg <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span>  <span class="co"># ensure the background color is white</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, type <span class="op">=</span> <span class="st">"n"</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">n</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>        <span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, <span class="va">y</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, pch <span class="op">=</span> <span class="fl">19</span>, cex <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span>        <span class="fu">ani.record</span><span class="op">(</span>reset <span class="op">=</span> <span class="cn">TRUE</span>, replay.cur <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>  <span class="co"># record the current frame</span></span></span>
<span class="r-in"><span>    <span class="op">}</span></span></span>
<span class="r-in"><span><span class="op">}</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> animation option 'nmax' changed: 50 --&gt; 21</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> animation option 'nmax' changed: 21 --&gt; 50</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> HTML file created at: index.html</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="ani.options.html">ani.options</a></span><span class="op">(</span><span class="va">oopts</span><span class="op">)</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Yihui Xie.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

